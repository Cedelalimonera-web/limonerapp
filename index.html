<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LimonerApp</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, Roboto;
  background: linear-gradient(180deg,#f2f5f0,#e3efe2);
}

.app {
  max-width: 420px;
  margin: auto;
  padding: 20px;
}

h1 { font-size: 28px; margin-bottom: 5px; }
.sub { color:#666; margin-bottom:20px; }

section { margin-top:30px; }

button {
  border:none;
  border-radius:20px;
  padding:10px 14px;
  font-size:15px;
  cursor:pointer;
}

.primary { background:#2d6a4f; color:white; }
.secondary { background:#e9efe4; color:#2d6a4f; }

.card {
  background:white;
  border-radius:16px;
  padding:14px;
  margin-top:12px;
  box-shadow:0 4px 10px rgba(0,0,0,.05);
}

.row { display:flex; justify-content:space-between; align-items:center; }
.small { font-size:14px; color:#666; }

.actions button {
  margin-left:6px;
  font-size:13px;
}

.modal {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  display:none;
  justify-content:center;
  align-items:center;
}

.modal-box {
  background:white;
  padding:20px;
  border-radius:16px;
  width:90%;
}

input {
  width:100%;
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
}
</style>
</head>

<body>
<div class="app">
  <h1>üçã LimonerApp</h1>
  <div class="sub">Control simple de campo</div>

  <section>
    <h2>Insumos</h2>
    <button class="secondary" onclick="openInsumo()">‚ûï Agregar insumo</button>
    <div id="insumos"></div>
  </section>

  <section>
    <h2>Tareas</h2>
    <button class="secondary" onclick="openTarea()">‚ûï Agregar tarea</button>
    <div id="tareas"></div>
  </section>
</div>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="modal-box">
    <h3 id="modalTitle"></h3>
    <input id="m1" placeholder="">
    <input id="m2" placeholder="">
    <div class="row" style="margin-top:15px">
      <button onclick="closeModal()">Cancelar</button>
      <button class="primary" onclick="saveModal()">Guardar</button>
    </div>
  </div>
</div>

<script>
let insumos = JSON.parse(localStorage.getItem("insumos")) || [];
let tareas = JSON.parse(localStorage.getItem("tareas")) || [];
let mode = "";

const modal = document.getElementById("modal");

function render() {
  const iDiv = document.getElementById("insumos");
  const tDiv = document.getElementById("tareas");
  iDiv.innerHTML = "";
  tDiv.innerHTML = "";

  insumos.forEach((i,idx)=>{
    iDiv.innerHTML += `
    <div class="card">
      <div class="row">
        <strong>${i.nombre}</strong>
        <span>${i.stock}</span>
      </div>
      <div class="actions">
        <button onclick="usar(${idx})">‚ûñ Usar</button>
        <button onclick="borrarInsumo(${idx})">üóëÔ∏è</button>
      </div>
    </div>`;
  });

  tareas.forEach((t,idx)=>{
    tDiv.innerHTML += `
    <div class="card">
      <div class="row">
        <span>${t}</span>
        <button onclick="borrarTarea(${idx})">‚úî</button>
      </div>
    </div>`;
  });

  localStorage.setItem("insumos",JSON.stringify(insumos));
  localStorage.setItem("tareas",JSON.stringify(tareas));
}

function openInsumo(){
  mode="insumo";
  modal.style.display="flex";
  modalTitle.innerText="Nuevo insumo";
  m1.placeholder="Nombre";
  m2.placeholder="Cantidad";
}

function openTarea(){
  mode="tarea";
  modal.style.display="flex";
  modalTitle.innerText="Nueva tarea";
  m1.placeholder="Descripci√≥n";
  m2.style.display="none";
}

function closeModal(){
  modal.style.display="none";
  m1.value=""; m2.value="";
  m2.style.display="block";
}

function saveModal(){
  if(mode==="insumo"){
    insumos.push({nombre:m1.value,stock:Number(m2.value)});
  }
  if(mode==="tarea"){
    tareas.push(m1.value);
  }
  closeModal();
  render();
}

function usar(i){
  const cant = prompt("Cantidad usada:");
  if(!cant) return;
  insumos[i].stock -= Number(cant);
  render();
}

function borrarInsumo(i){
  insumos.splice(i,1);
  render();
}

function borrarTarea(i){
  tareas.splice(i,1);
  render();
}

render();
</script>
</body>
</html>
